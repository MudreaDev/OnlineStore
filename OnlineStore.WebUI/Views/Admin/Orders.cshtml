@model IEnumerable<OnlineStore.Domain.Entities.Order>

@{
    ViewData["Title"] = "Order Logistics";
}

<style>
    .admin-page {
        padding-top: 2rem;
        padding-bottom: 5rem;
    }

    .page-header {
        display: flex;
        align-items: center;
        justify-content: space-between;
        margin-bottom: 3rem;
    }

    .admin-title {
        font-family: var(--font-display);
        font-size: 2.25rem;
        font-weight: 800;
        color: var(--midnight);
        letter-spacing: -0.02em;
    }

    .stat-pill {
        background: var(--bg-base);
        padding: 0.5rem 1rem;
        border-radius: 99px;
        font-size: 0.75rem;
        font-weight: 700;
        color: var(--text-muted);
        border: 1px solid var(--border-subtle);
    }

    /* --- Refined Table Card --- */
    .inventory-card {
        background: #fff;
        border: 1px solid var(--border-subtle);
        border-radius: 24px;
        overflow: hidden;
        box-shadow: var(--shadow-sm);
    }

    .inventory-table {
        width: 100%;
        border-collapse: collapse;
    }

    .inventory-table thead {
        background: var(--bg-base);
        border-bottom: 1px solid var(--border-subtle);
    }

    .inventory-table th {
        padding: 1.25rem 1.5rem;
        text-align: left;
        font-size: 0.65rem;
        font-weight: 800;
        text-transform: uppercase;
        color: var(--text-muted);
        letter-spacing: 0.1em;
    }

    .inventory-table td {
        padding: 1.25rem 1.5rem;
        font-size: 0.875rem;
        color: var(--text-main);
        border-bottom: 1px solid var(--border-subtle);
        vertical-align: middle;
    }

    .inventory-table tr:last-child td {
        border-bottom: none;
    }

    .inventory-table tbody tr:hover {
        background: var(--bg-base);
    }

    .order-reference {
        font-weight: 700;
        color: var(--midnight);
        font-family: var(--font-display);
    }

    .customer-info {
        font-size: 0.75rem;
        color: var(--text-muted);
        margin-top: 0.25rem;
    }

    .order-total {
        font-weight: 800;
        color: var(--midnight);
        font-family: var(--font-display);
    }

    /* Refined Status Select */
    .status-wrap {
        position: relative;
        display: inline-block;
    }

    .luxury-status-select {
        appearance: none;
        padding: 0.5rem 2rem 0.5rem 1rem;
        border-radius: 12px;
        font-size: 0.75rem;
        font-weight: 800;
        text-transform: uppercase;
        letter-spacing: 0.05em;
        cursor: pointer;
        border: 1.5px solid transparent;
        transition: var(--transition-smooth);
        outline: none;
        background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='10' height='6' viewBox='0 0 10 6'%3E%3Cpath d='M0 0l5 6 5-6z' fill='%23111827'/%3E%3C/svg%3E");
        background-repeat: no-repeat;
        background-position: right 0.75rem center;
    }

    .status-pending {
        background: #fffbeb;
        color: #92400e;
        border-color: #fef3c7;
    }

    .status-processing {
        background: #eff6ff;
        color: #1e40af;
        border-color: #dbeafe;
    }

    .status-shipped {
        background: #ecfdf5;
        color: #065f46;
        border-color: #d1fae5;
    }

    .status-delivered {
        background: #f0fdf4;
        color: #166534;
        border-color: #dcfce7;
    }

    .status-cancelled {
        background: #fef2f2;
        color: #991b1b;
        border-color: #fee2e2;
    }

    .luxury-status-select:focus {
        box-shadow: 0 0 0 4px rgba(0, 0, 0, 0.05);
    }
</style>

<div class="container admin-page fade-in">
    <div class="page-header">
        <h1 class="admin-title">Order <span style="font-weight: 300; opacity: 0.5;">Logistics</span></h1>
        <div class="stat-pill">@Model.Count() Orders Tracked</div>
    </div>

    <div class="inventory-card">
        @if (!Model.Any())
        {
            <div style="text-align: center; padding: 6rem 2rem;">
                <div style="font-size: 3rem; margin-bottom: 1.5rem; opacity: 0.3;">ðŸ“‹</div>
                <h4 style="font-family: var(--font-display); color: var(--midnight);">No orders processed</h4>
                <p style="color: var(--text-muted); font-size: 0.875rem;">Orders will appear here once customers finalize
                    their selection.</p>
            </div>
        }
        else
        {
            <table class="inventory-table">
                <thead>
                    <tr>
                        <th>Manifest</th>
                        <th>Stakeholder</th>
                        <th>Total Value</th>
                        <th>Status Selection</th>
                    </tr>
                </thead>
                <tbody>
                    @foreach (var order in Model)
                    {
                        var statusClass = "status-" + order.Status.ToString().ToLower();
                        <tr>
                            <td>
                                <div class="order-reference">Selection ID: @order.Id.ToString().Substring(0, 8).ToUpper()</div>
                                <div class="customer-info">
                                    @order.OrderDate.ToString("MMM d, yyyy") â€” @order.Items.Sum(i => i.Quantity) items
                                </div>
                            </td>
                            <td>
                                <div style="font-weight: 700; color: var(--midnight);">@order.User.Username</div>
                                <div style="font-size: 0.7rem; color: var(--text-muted);">Registered Client</div>
                            </td>
                            <td class="order-total">@order.Total.ToString("C0")</td>
                            <td>
                                <div class="status-wrap">
                                    <form asp-action="UpdateOrderStatus" method="post">
                                        <input type="hidden" name="orderId" value="@order.Id" />
                                        <select name="status" class="luxury-status-select @statusClass"
                                            onchange="this.className = 'luxury-status-select status-' + this.value.toLowerCase(); this.form.submit()">
                                            @foreach (var status in
                                           Enum.GetValues(typeof(OnlineStore.Domain.Enums.OrderStatus)))
                                            {
                                                <option value="@status"
                                                    selected="@(order.Status.ToString() == status.ToString() ? "selected" : null)">
                                                    @status
                                                </option>
                                            }
                                        </select>
                                    </form>
                                </div>
                            </td>
                        </tr>
                    }
                </tbody>
            </table>
        }
    </div>
</div>
